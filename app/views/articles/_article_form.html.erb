<div class="row">
    <div class="col-md-8 col-md-offset-2 article-form">
        <%= form_for(@article, html: { multipart: true }) do |f| %>
            <%= render 'partials/error_messages', object: f.object %>

            <div class="form-group">
                <%= f.label :title, class: 'control-label' %>
                <%= f.text_field :title, class: 'form-control input-lg', placeholder: 'article title', autofocus: true %>
            </div>
            <div class="form-group">
                <%= f.label :content, class: 'control-label' %>
                <%= f.text_area :content, class: 'form-control', rows: 6, placeholder: 'article content' %>
            </div>
            <div class="form-group">
                <%= f.label :tag_list, class: 'control-label' %>
                <%= f.select :tag_list, Tag.all.collect { |t| [t.name, t.name] },
                             {selected: @article.tags.collect { |t| t.name }},
                             {id: 'tags-list-selection', class: 'form-control', multiple: true} %>
            </div>
            <div class="form-group">
                <%= f.label :picture, class: 'control-label' %>
                <%= f.file_field :picture, accept: 'image/jpeg,image/gif,image/png' %>
                <p class="help-block">Choose your picture to upload</p>
            </div>

            <button type="submit" class="btn btn-success btn-lg"><%= yield(:article_form_button) %></button>
        <% end %>
    </div>
</div>


<script>
    $(document).ready(function() {
        $(function() {
            var $picture = $('#article_picture');
            var $selectBox = $('#tags-list-selection');

            $selectBox.select2({
                placeholder: "select tags for your article (default is 'general')",
                allowClear: true
            });

            $picture.bind('change', function() {
                var size_in_megabytes = this.files[0].size / 1024 / 1024;
                if (size_in_megabytes > 5) {
                    alert('Maximum file size is 5MB. Please choose a smaller file.');
                }
            });
        });
    });
</script>